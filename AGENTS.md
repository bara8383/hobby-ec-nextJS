# AGENTS.md

> Codex が実装時に最初に読む運用ルールです。**迷ったらこのファイルを優先**してください。

---

## このプロジェクトの設計・実装方針

> 以下の 1〜4 は**上から順に優先順位が高い**。競合する場合は `1 > 2 > 3 > 4` の順で判断する。

1. **Next.js の最新設計を採用する。**
2. **SEO を高度に最適化する。**
3. **リアルタイムチャット機能を実装する。**
4. **AWS に最小コストでデプロイする。**

---

## 作業におけるルール

- PR 本文は **必ず日本語** で、後述「PR 記載テンプレート」通りに作成する。
- PR 作成のため、リポジトリへ変更を入れる前に必ず作業ブランチを作成する。
- **方針 1〜4 に基づく判断を行った場合、PR の「実装理由」に “判断した論点” を明記する。**

  例：
  - App Router 前提
  - Server Components 優先
  - Metadata API 使用
  - ISR 採用
  - JSON-LD 追加
  - コスト最小化のため Lambda 採用 など

- **以下に該当する“大きめの設計選択”を行った場合は、比較案を最低 1 つ記載し、却下理由も必ず書く。**

  該当例：
  - 新規ライブラリ導入
  - ルーティング方式変更
  - データ取得方式変更（fetch/SSR/ISR 等）
  - SEO 出力方式変更（metadata / Head / JSON-LD 等）
  - インフラ構成変更

---

## PR 記載テンプレート

PR の本文は **必ずこの順序・見出し名で** 記載する。

### 1) 実装・修正内容
- 何を変更したかを箇条書きで記載する。
- UI 変更時は対象画面/コンポーネント名を書く。

### 2) 実装理由
- 採用理由（性能・保守性・コスト・納期）を必ず記載する。
- 方針 1〜4 のどれを考慮したか明記する。
- 比較した案がある場合は、比較した案の内容と却下理由も必ず記載する。

### 3) 変更ファイル
- 主要ファイルのみを列挙し、各ファイルの変更意図を 1 行で書く。

### 4) 動作確認
- 実行コマンドをコードブロックで記載し、各コマンドに `PASS` / `FAIL` を明記する。
- 手動確認を行った場合は、確認手順と結果を記載する。

### 5) 影響範囲
- 以下 4 項目を必ず記載する（影響なしでも `なし` と書く）。
  - Next.js 最新設計への整合性
  - SEO 影響
  - リアルタイムチャット機能への影響
  - AWS コスト影響（増減見込み）

### 6) 提案・懸念点
- 当該タスクで発生・確認した repo 内の提案/懸念/問題点を箇条書きで記入する。
- また、上記を `docs/proposals.md` に追記する。

### 7) リスクとロールバック
- 想定リスクを箇条書きで記載する。
- 必要に応じてロールバック方法も記載する。
